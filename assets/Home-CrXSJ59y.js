import{c as x,R as j,j as e,L as b,r as c,u as f,a as N,E as v}from"./index-B4VRU7rX.js";import{G as k,B as w,u as C}from"./BgImage-NOYYMoVW.js";const S=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],R=x("coins",S);const A=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],B=x("search",A);const I=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],E=x("send",I);const G=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],g=x("sparkles",G);function _({game:r}){return e.jsx("ul",{className:"flex flex-wrap gap-1 mb-2 absolute bottom-2 left-2 z-50 rounded-2xl p-1",children:r.genres?.length>0&&r.genres.map((a,s)=>e.jsx("li",{className:"text-sm py-1.5 px-3 bg-(--color-bg-primary) opacity-85 rounded-2xl border-2 border-(--color-text-tertiary)",children:a.name},`${r.name}-genre-${s}`))})}const $=j.memo(_);function y({platform:r}){return e.jsx("span",{children:r.platform.name})}function z({game:r}){return e.jsx("ul",{className:"flex text-xs gap-1 items-center flex-wrap font-bold",children:r.platforms?.length>0&&r.platforms.map((a,s)=>s!==0?e.jsxs("li",{className:"flex gap-1",children:[e.jsx("span",{className:"text-(--color-accent-primary)",children:"â€¢"}),e.jsx(y,{platform:a})]},a.platform.name):e.jsx("li",{children:e.jsx(y,{platform:a})},a.platform.name))})}const T=j.memo(z);function q({game:r,priority:a=!1}){return e.jsxs(b,{to:`/game/${r.id}`,className:"flex flex-col gap-4 p-4 bg-(--color-bg-secondary) rounded-2xl group border-y-2 border-y-(--color-accent-primary) hover:border-y-(--color-accent-secondary) transition-all transition-100 hover:scale-105",children:[e.jsxs("div",{className:"flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsx("h2",{className:"font-gonadaltes tracking-wider uppercase text-lg text-(--color-text-tertiary) font-bold mb-1 wrap-break-words",children:r.name}),e.jsx(k,{rating:r.rating})]}),e.jsx(T,{game:r})]}),e.jsxs("div",{className:"relative w-full h-64",children:[e.jsx(w,{gameName:r.name,gameBgImage:r.background_image,priority:a}),e.jsx($,{game:r})]})]})}function M(r,a=500){const s=c.useRef(null),i=c.useRef(r);c.useEffect(()=>{i.current=r},[r]);const o=c.useCallback((...t)=>{s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{i.current(...t)},a)},[a]);return c.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]),o}function L({remaining:r,total:a=6}){const s=r===0,{resetRateLimit:i}=f();return e.jsxs("div",{className:"flex items-center gap-2 text-sm flex-wrap",children:[e.jsx("div",{className:"flex gap-1",children:Array.from({length:a}).map((o,t)=>e.jsx(R,{size:16,style:{color:t<r?"var(--color-accent-primary)":"var(--color-text-tertiary)",opacity:t<r?1:.3}},t))}),e.jsxs("span",{className:"opacity-70",style:{color:s?"#ef4444":"inherit"},children:[r,"/",a," searches left today"]}),!1]})}function F({onSearch:r}){const{isAiSearch:a,setIsAiSearch:s,remainingAiRequests:i}=f(),[o,t]=c.useState(""),l=c.useRef(null),h=c.useCallback(d=>{a||r(d)},[r,a]),p=M(h),n=d=>{t(d.target.value),p(d.target.value),l.current&&(l.current.style.height="auto",l.current.style.height=`${l.current.scrollHeight}px`)},u=d=>{d.preventDefault(),a&&o.trim()&&r(o)},m=()=>{t(""),r(""),s(!a),l.current&&(l.current.style.height="auto")};return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[a&&e.jsx(L,{remaining:i}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsxs("label",{htmlFor:"ai-toggle",className:`text-sm font-medium flex items-center gap-1 ${a?"text-(--color-accent-primary)":""}`,children:[e.jsx(g,{size:20}),"AI Search"]}),e.jsx("button",{id:"ai-toggle",onClick:m,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors border-2 cursor-pointer",style:{backgroundColor:a?"var(--color-accent-primary)":"var(--color-bg-tertiary)",borderColor:"var(--color-bg-secondary)"},children:e.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform",style:{transform:a?"translateX(24px)":"translateX(4px)"}})})]})]}),e.jsxs("div",{className:"rounded-full w-full transition duration-300 relative",style:{backgroundColor:"var(--color-bg-secondary)",color:"var(--color-text-primary)"},children:[a?e.jsx(g,{className:"absolute left-2 top-1/2 -translate-y-1/2"}):e.jsx(B,{className:"absolute left-2 top-1/2 -translate-y-1/2"}),e.jsxs("form",{onSubmit:u,children:[e.jsx("label",{htmlFor:"search-game-input",className:"sr-only",children:"Search for a game"}),a?e.jsxs(e.Fragment,{children:[e.jsx("textarea",{ref:l,id:"search-game-input",value:o,onChange:n,className:"py-2 pl-10 pr-12 w-full rounded-full outline-none resize-none flex items-center overflow-hidden",style:{lineHeight:"1.5rem",paddingTop:"0.5rem",paddingBottom:"0.5rem",minHeight:"2.5rem",maxHeight:"10rem"},placeholder:"Describe games... e.g. 'cozy RPG on Game Boy'",rows:1}),e.jsx("button",{type:"submit",disabled:i===0,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded-full transition-colors hover:opacity-70 cursor-pointer disabled:opacity-30 disabled:cursor-not-allowed",style:{color:"var(--color-accent-primary)"},"aria-label":"Submit AI search",children:e.jsx(E,{size:20})})]}):e.jsx("input",{id:"search-game-input",value:o,onChange:n,type:"text",className:"py-2 pl-10 pr-6 w-full rounded-full outline-none",placeholder:"Search games by title..."})]})]})]})}const H="/assets/no-games-COKJArUt.webp";function P({explanation:r,gameCount:a}){return e.jsx("div",{className:"mb-6 p-4 rounded-lg border",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-accent-primary)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(g,{className:"mt-1 shrink-0",style:{color:"var(--color-accent-primary)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg leading-relaxed",children:r}),e.jsxs("p",{className:"text-sm mt-2 opacity-70",children:["Showing ",a," AI-validated results"]})]})]})})}function Q(){const[r,a]=c.useState(""),{isAiSearch:s,fetchGames:i,fetchAiGames:o}=f(),{data:t,isPending:l,isError:h,error:p}=C({queryKey:["games",{searchTerm:r,isAiSearch:s}],queryFn:({signal:m})=>s?o({signal:m,query:{searchTerm:r}}):i({signal:m,query:{searchTerm:r}}),staleTime:5e3,enabled:s?r.trim().length>0:!0}),n=s?t?.games:t,u=s?t?.explanation:null;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"m-auto md:max-w-2/3 lg:max-w-1/2 mb-8",children:e.jsx(F,{onSearch:a})}),l&&r.trim().length>0&&e.jsx(N,{}),h&&e.jsx(v,{errorMessage:p.message}),s&&u&&n&&n.length>0&&e.jsx(P,{explanation:u,gameCount:n.length}),!l&&n&&n.length===0&&e.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[e.jsxs("h1",{className:"text-2xl font-bold text-center",children:["No games found ",e.jsx("br",{}),"Search again"]}),e.jsx("img",{src:H,alt:"No games found",className:"w-50"})]}),e.jsx("ul",{className:"grid grid-cols-[repeat(auto-fit,minmax(250px,1fr))] gap-4",children:n&&n.map((m,d)=>e.jsx("li",{children:e.jsx(q,{game:m,priority:d<4})},m.id))})]})}export{Q as default};
